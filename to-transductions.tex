\newcommand{\Root}[1]{\mathsf{root}_{#1}}
\newcommand{\Port}[1]{\mathsf{port}_{#1}}
\newcommand{\Interface}[1]{\mathsf{Interface}_{#1}}
\section{Derivable functions are first-order transductions}
\label{sec:to-transductions}
In this section, we give an overview on the proof of the right-to-left implication in Theorem~\ref{thm:main}, namely that if $\rSigma,\rGamma$ are finite ranked sets, then for every derivable function $\ranked {f : \tmonad \rSigma \to \tmonad \rGamma}$, its restriction to trees $f : \trees \rSigma \to \trees \rGamma$
is a first-order tree-to-tree transduction. The proof is a simple induction on the derivation of  $\ranked f$. In the induction, we must deal with functions that manipulate types that are more complex than trees, e.g.~tensor pairs of terms of coproducts.  To operate on such types with first-order transductions, we need to show how such types can be modeled as relational structures. For this purpose, we associate to each type $\rSigma$
\begin{itemize}
\item a relational vocabulary denoted  \emph{voc$ \rSigma$};
\item a map 
 \begin{align*}
        a \in \rSigma \qquad \mapsto \qquad \underline a \in \text{models over voc$ \rSigma$}.
    \end{align*}
    which interprets every inhabitant of $\rSigma$ as a relational structure over the vocabulary of $\rSigma$,
\end{itemize}
both defined in a natural way by induction on types. Their precise definition are given in Appendix~\ref{sec:to-logic}, Definition~\ref{def:type-model}.
    \smallskip

The following proposition immediately yields the right-to-left implication in Theorem~\ref{thm:main}. Its proof, which is a straightforward case analysis of all atomic functions and combinators, is in the appendix. 


  
\begin{proposition}\label{prop:to-logic} If $f : \rSigma \to \rGamma$ is derivable, then there is a first-order transduction $g$ 
    which makes the following diagram commute
    \begin{align*}
        \xymatrix@C=3cm{
            \rSigma \ar[d]_{a \mapsto \underline a}\ar[r]^f &  \rGamma \ar[d]^{a \mapsto \underline a} \\
            \text{models over  Voc$\rSigma$} \ar[r]_g &  \text{models over Voc$ \rGamma$}.
        } 
    \end{align*}
\end{proposition}



